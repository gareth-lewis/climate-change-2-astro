---
// Component Imports
import BaseHead from '../components/BaseHead.astro';
import Header from '../components/Header.astro';
import FeaturedArticle from '../components/Article/FeaturedArticle.astro';
import ArticlePreview from '../components/Article/ArticlePreview.astro';
import RelatedLinks from '../components/RelatedLinks/RelatedLinks.astro';

let serviceName = "Climate Change";

let title = "Articles"
let description = "See a list of articles related to Climate Change"
let permalink = "https://climate-change.data.gov.uk/articles";

// Data Fetching: List all Markdown posts in the repo.
let allPosts = await Astro.fetchContent('./articles/*.md');
allPosts = allPosts.sort((a, b) => new Date(b.publishDate).valueOf() - new Date(a.publishDate).valueOf());
---

<html lang="en">
	<head>
		<BaseHead title={title} description={description} permalink={permalink} />
	</head>

	<body>
		<Header serviceName={serviceName} alternativeAccent={false} />

        <section class="featured-article">
            <div class="govuk-container">
                <h1 class="heading-xl">Articles</h1>

                <!-- Make the latest article featured -->
                <FeaturedArticle article={[...allPosts][0]} />
            </div>
        </section>

        <!-- Skip the first article and provide a summary -->
        <div class="govuk-container">
            <div class="layout">
                <section class="articles">
                    {allPosts.slice(1).map((article) => (
                        <ArticlePreview article={article} />
                    ))}
                </section>
                <aside>
                    <section class="updates border-top">
                        <h1 class="heading-m">Sign up and manage updates</h1>

                        <ul>
                            <li>
                                <a href="#">
                                    <span class="icon">
                                        <svg width="24" height="18" viewBox="0 0 24 18" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" clip-rule="evenodd" d="M20.5858 2H3.41421L12 10.5858L20.5858 2ZM2 3.41421V16H22V3.41421L12.7071 12.7071L12 13.4142L11.2929 12.7071L2 3.41421ZM0 0H2H22H24V2V16V18H22H2H0V16V2V0Z" fill="white"/>
                                        </svg>
                                    </span>
                                    <span class="label">Email</span>
                                </a>
                            </li>
                            <li>
                                <a href="#">
                                    <span class="icon">
                                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" clip-rule="evenodd" d="M0 4C8.83656 4 16 11.1634 16 20H20C20 8.9543 11.0457 0 0 0V4ZM8 20C8 15.5817 4.41828 12 0 12V8C6.62742 8 12 13.3726 12 20H8ZM4 18C4 19.1046 3.10457 20 2 20C0.89543 20 0 19.1046 0 18C0 16.8954 0.89543 16 2 16C3.10457 16 4 16.8954 4 18Z" fill="white"/>
                                        </svg>
                                    </span>
                                    <span class="label">RSS</span>
                                </a>
                            </li>
                        </ul>
                    </section>
                    
                    <RelatedLinks />

                </aside>
            </div>
        </div>
	</body>
</html>

<style>
    .featured-article {
        background-color: var(--color-light-grey);
        padding: 72px 0 56px;
        margin-bottom: 56px;
    }

    .layout {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 48px;
    }

    .featured-article h1 {
        margin-bottom: 56px;
    }

    .articles h1, .related-links h1 {
		margin-bottom: 24px;
        clear: both;
	}

	.border-top {
		border-top: 4px solid var(--color-brand);
		padding-top: 16px;
	}

    aside section {
        margin-bottom: 48px;
    }

    .updates h1 {
        margin-bottom: 24px;
    }

    .updates ul li {
        display: inline-block;
        width: 49%;
    }

    .icon {
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: var(--color-brand);
        height: 32px;
        width: 32px;
        float: left;
        margin-right: 16px;
    }

    .label {
        font-family: 'GDS Transport Bold', sans-serif;
        font-weight: 700;
        display: inline-block;
        margin-top: 6px;
    }
</style>